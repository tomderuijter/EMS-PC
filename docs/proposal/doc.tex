% Needed packages
\documentclass[a4paper, 10pt, english, twocolumn]{article}
\usepackage[english]{babel}
\usepackage[cm]{fullpage}
\usepackage{cite}
\usepackage{anysize}
\usepackage[compact]{titlesec}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{hyperref}

\usepackage{amssymb,amsmath}
\usepackage{algorithmicx}
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}

\usepackage{pgfgantt}

\newcommand{\keywords}[1]{\par\noindent 
{\bf Keywords\/}. #1}

% Margins & Headers
\marginsize{2.5cm}{2.5cm}{2cm}{1.5cm}
\columnsep 0.4in
\footskip 0.4in 
\usepackage{changepage}

% E-mail formatting
\usepackage{color,hyperref}
    \catcode`\_=11\relax
    \newcommand\email[1]{\_email #1\q_nil}
    \def\_email#1@#2\q_nil{
      \href{mailto:#1@#2}{{\emailfont #1\emailampersat #2}}
    }
    \newcommand\emailfont{\sffamily}
    \newcommand\emailampersat{{\color{red}\small@}}
    \catcode`\_=8\relax 
	
% List modifications
\newenvironment{packed_item}{
\begin{itemize}
  \setlength{\itemsep}{1pt}
  \setlength{\parskip}{0pt}
  \setlength{\parsep}{0pt}
}{\end{itemize}}

\newenvironment{packed_enum}{
\begin{enumerate}
  \setlength{\itemsep}{1pt}
  \setlength{\parskip}{0pt}
  \setlength{\parsep}{0pt}
}{\end{enumerate}}

% ### Mathematics ###
\newcommand{\bpm}{\begin{pmatrix}}
\newcommand{\epm}{\end{pmatrix}}

\newcommand{\bbm}{\begin{bmatrix}}
\newcommand{\ebm}{\end{bmatrix}}

\newcommand{\bsm}{\bigl( \begin{smallmatrix}}
\newcommand{\esm}{ \end{smallmatrix} \bigl)} 

\newcommand{\mbf}{\mathbf}

% ### Matrices and Vectors ###
\newcommand{\mtx}[1]{\ensuremath{\boldsymbol{#1}}}
\newcommand*\Let[2]{\State #1 $\gets$ #2}

% ### Sets ###
\newcommand{\set}[1]{\ensuremath{\mathcal{#1}}}

% ### Other ###

\newcommand{\transpose}{^{T}}
\newcommand{\inv}{^{-1}}
\newcommand{\pseudoinv}{^{+}}
% ############## End Macros ##############

% Title
\title{\fontfamily{phv}\selectfont{Causal Discovery methods for Effective Connectivity}}
\author{
  \textbf{Ramon Janssen} - \href{mailto:ramon.janssen@student.ru.nl}{ramon.janssen@student.ru.nl} \\
  \textbf{Tom de Ruijter} - \href{mailto:t.deruijter@student.ru.nl}{t.deruijter@student.ru.nl}
}

\date{\fontfamily{ptm}\selectfont{\small{\bfseries{\today - Radboud
Universiteit Nijmegen}}}\\[0.5cm]\rule{\linewidth}{0.3mm}}

\begin{document}

\maketitle

\begin{abstract}
Lorem Ipsum Dolor Sit Amet.
\keywords{Keywords}
\end{abstract}

\setlength{\parindent}{0.0cm}
\setlength{\parskip}{0.25cm}

\section{Introduction}

% vergelijking met granger causality, en andere methodes?
% granger (Alard Roebroeck, Elia Formisano, Rainer Goebel, 2005) -> geen structural connectivity nodig (schaalt niet goed)
% covariance structural equation modeling -> structural connectivity nodig (Roebroeck, Formisano, Goebel, 2005)
% Multivariate autoregressive modeling (Harrison, Penny, Friston) -> Set of interaccting regions chosen beforehand (Roebroeck, Formisano, Goebel, 2005)
% Dynamic causal modelling (Friston, Harrison, Penny, 2003) -> Set of interaccting regions chosen beforehand (Roebroeck, Formisano, Goebel, 2005)

% Introductory small-talk
% ...

\paragraph{Motivation}
The brain and particularly the human brain have been studied for hundreds of years.
Today, the secrets of our brains still are one of the most sought-after.
The techniques however have changed.
Today, advanced measurement methods exist that allow scientists to peek inside brains that give a coarse but broad overview without opening a single skull.

Of particular interest are causal relations between brain regions and cognitive and bodily functions.
We have come a long way since the time of Phrenology, the pseudoscience based attempting to derive cognitive ability and personality from measurements of the skull or, post-mortem, the brain.
The question whether brain region X is somehow connected to brain region Y is still highly relevant; it is the main question of the present-day scientific field of brain connectivity.
Understanding brain structure implies understanding more about the brain as a whole.

Not surprisingly, brain connectivity also finds applications in medicine.
Neuro-degenerative diseases such as Alzheimer's disease, Parkinson's disease, dementia, Amyotrophic lateral sclerosis (ALS) have all been shown to severely alter brain connectivity. %TODO: Citation needed.
Better methods for analysing connectivity could lead to more insight in these diseases.

The field of brain connectivity finds its roots in the early 1990s \cite{friston1993functional, friston1994}, though because of more recent developments in the field of Artificial Intelligence and Machine Learning it is possible to do more thorough analysis \cite{vandenheuvel2010}.
One type of connectivity analysis involves finding causal relations between brain areas, specifically \emph{effective connectivity}.
However, causal analysis is also relatively new and its application in brain connectivity analysis still faces many challenges that require further research \cite{ramsey2010}.

\paragraph{Problem statement}
This project seeks to combine the strengths of current state-of-the-art causal discovery methods and apply them to resting state brain fMRI data in order to find new applicable methods for determining causal patterns in the human brain.

The work by \cite{ramsey2010} addresses several problems causal analysis in fMRI analysis suffers from.
Methods in causal discovery have high computational bounds, making it nearly impossible to calculate networks with more than hundreds of nodes.
Another import fact is fMRI Analysis indirectly measures brain activity.
Brain models that do not account for possible latent - indirect - sources within the brain or the shortcomings of fMRI may suffer from noise or fail to capture underlying patterns.
Another problem is the strong diversity between measurement subjects.
Every brain is inherently different, making it non-trivial to combine subject data or even draw conclusions across subjects.
Even within a single brain, how different areas react over time changes.

Several methods for finding effective connectivity already exist \cite{mclntosh1994, harrison2003, friston2003, roebroeck2005}.
However using more generally applicable causal discovery methods has not been elaborated on much.
Also, none of these provide a measure of uncertainty.
It is a fact that there are errors in any graph produced.
This is inherent to the methods and the coarseness of the measurements.
As there is no standard baseline to compare results with, a measure of uncertainty would be highly preferable.
A framework for such a probabilistic approach is introduced in \cite{claassen2012}.

We would like to know whether applying such methods, such as the approach introduced in \cite{claassen2012}, or a standard approach such as PC-algorithm \cite{spirtes2000} can solve some of the difficulties effective connectivity suffers from.

% Structure of the rest of proposal
In the remainder of this proposal we briefly discuss some necessary background knowledge on connectivity and methods, we then discuss our strategy and finally we present a time-plan overview.

\section{Theory}

\subsection*{Brain connectivity}

%Question: should this be included?
\subsubsection*{Functional connectivity}
Functional connectivity describes the statistical dependance of neuronal activity between different brain regions \cite{friston1993functional}.
It gives an insight in the organisation of the brain, even though the exact functioning is still unclear.
Functional connectivity is strongly time-dependant, as activity changes rapidly providing only a small time window to measure.
This means measured dependencies can be the result of statistical noise.
Functional connectivity can concisely be deduced by measurement of brains in resting-state \cite{Lowe2000, doria2010, Bullmore2009}.
Resting state indicates that subjects are instructed to relax without thinking of anything in particular, to stimulate spontaneous brain activity.

\subsubsection*{Structural connectivity}
The structural connectivity is a mapping of the physical paths in the brain, and it shows the neural connections between anatomically separated brain regions.
This is strongly related with functional connectivity: regions can only be functionally connected if there is a physical connection between them.
This is an intuitive relation, and is also shown experimentally \cite{vandenheuvel2009}.


%Similarly, there is the field of structural connectivity, which is defined as the mapping of direct anatomical brain pathways \cite{friston1994}.
%It refers to white matter tracts, describing the millions of long-distance axons or `brain highways', connecting large groups of spatially separated brain areas.
%In accordance with intuition, a recent study has shown that both fields are related.
%By demonstrating that almost all functionally linked regions of the most reported resting-state networks are also structurally connected by known white matter tracts \cite{vandenheuvel2009}.
%Also, functional connectivity is constrained by structural connectivity \cite{cabral2012}.
%Structural connectivity is less time dependent, as it involves the mapping of anatomical connections opposing activity patterns.

\subsubsection*{Effective connectivity}
In contrast to functional and structural connectivity, effective connectivity takes into account the cause and effect of relations.
It has been described as ``the influence one neural system exerts over another'' \cite{friston1994}.
Effective connectivity indicates which brain regions stimulate other regions.
Time series need to be analysed to infer effective connectivity as cause and effect can be deduced from which event precedes which. 
It is possible to infer effective connectivity from structural and functional connectivity.

%Much progress has recently been made in the fields of structural and functional connectivity\cite{vandenheuvel2010}.
%Research has also been done on inferring effective connectivity, based on Granger causality \cite{Roebroeck2005}, Structural equation modelling \cite{mclntosh1994}, multivariate autoregressive modeling \cite{harrison2003} and dynamic causal modelling \cite{friston2003}.
%However, many challenges are still being faced \cite{ramsey2010}. One example of this is that not all approaches have a good schaling, and as such they cannot be applied to large datasets. Another problem is that not all methods can cope with latent variables, and wrong directive relations can be concluded.

\subsection*{Causal discovery methods}
The first causal method that we will use to find effective connectivity will be the PC-algorithm.
This is a state of the art used for general causal discovery, which finds the structure and the direction of connections of this network.
If a graph skeleton of a network is already known beforehand, this can also be used as a basis such that the PC-algorithm can determine the directions.
Another causal discovery method is the BCCD-algorithm \cite{claassen2012}, which gives similar results as PC.
This algorithm has some useful properties; it is based on a Bayesian approach and as such, it is robust.
It also does not need any assumptions beforehand.
Because of this, the algorithm performs at least as good as other causal discovery algorithms such as FCI and PC in benchmarks on representative datasets, and in some cases it performs better.
BCCD also finds the reliability of found connections, giving additional information compared to PC and FCI. 


\subsection*{Data acquisition \& analysis}
To find effective connectivity, structural and functional connectivity are needed.
The datasets on which the causal discovery methods will be applied are DTI and fMRI-measurements of six subjects. Structural connectivity of these subjects follows directly from DTI-measurements.
The functional connectivity can be extracted from these fMRI-measurement, possibly in combination with the structural connectivity. This data is already available.

%Within these areas methods are applied on connectivity patterns obtained from fMRI analysis to predict anatomical connections.
%It is possible to obtain anatomical connectivity patterns by applying partial correlation methods to resting-state fMRI data, filtering out poly-synaptic activity. %TODO: Reference needed.
%Another option is to apply Diffusion Tensor Imaging (DTI) to resting-state data, which maps water diffusion directions in the brain, as this is a more direct way of charting brain highways. %TODO: Reference needed.

%Both methods, i.e. correlation analysis and DTI, have downsides and ideally one would hope to combine them to have the best of both worlds.
%% Note: de onderstaande uitspraak klopt dus niet voor ons proposal
%Such a thing is possible when using Bayesian methods. In this proposal however, we focus on frequentistic or data driven methods, as they usually provide a computational advantage without a large performance trade-off.
%However, this also limits the amount of brain modelling we can do.

% Note: bekijk even of de onderstaande sectie Ÿberhaupt wel interessant is. Ik heb het gebruikt als introductie voor mijn formele uitleg. Die laatste ontbreekt nu natuurlijk.

% Brain robustness and neuro-degeneration
%\subsection*{Brain robustness and neuro-degeneration}
%Investigating the brain as an integrative network of interacting regions has proven to be a fruitful platform for learning more about how the brain functions.
%Its main premise is that the brain can be modelled as a graph $G=(\set{V},E)$, $\set{V}$ being a collection of brain areas and $E$ the connections between those.
%It provides ideas for brain robustness and forms a basis for approaching certain neuro-degenerative diseases, e.g. Alzheimer's disease (AD), as these are known to affect brain connectivity \cite{Bullmore2009, vandenheuvel2010}.
%Several studies have shown that the brain network is organised according to an efficient \emph{small-world} organization \cite{vandenheuvel2008, vandenheuvel2010}.
%Some of these suggest that brain connectivity is distributed according to a power-law function, possibly explaining the brain's scale-free organisation of connectivity networks.
%Scale-free networks are renowned for their robustness against random attacks and so it forms an interesting hypotheses for modelling brain networks.
%Even more, since scale-free organisation is susceptible to specialised attacks on hub nodes, it could be so that these hub nodes are affected in AD.
%This idea is based on resting state fMRI data and graph analysis, as well as MEG results \cite{buckner2009, stam2009}

% Note: voor onderstaande tekst geldt: kijk even kritisch of we het nodig hebben.

%\subsection{Analysing connectivity}
%Where brain data is usually available in abundant amounts, testing subjects are not.
%This, and large cross-subject divergence makes it difficult to compare (diseased) brain area's between subjects and conclusions between studies.
%To still pinpoint Regions of Interest (ROI) between subject, one can use so called labelling atlases, such as the Automatic Anatomical Labeling atlas, to map brain areas to known ROI's.
%Another option is to apply a custom clustering to brain data such as attempted in \cite{craddock2012}.
%They found this to be preferable interpretability can be sacrificed for accuracy.
%In short, by clustering adjacency patterns of functional connectivity maps, it is also possible to obtain precise and functionally homogenous parcels within human brains.

\section{Methods \& Strategy}
%Short general introduction to both methods
In this project, causal discovery algorithms will be applied to a dataset of functional and structural connectivity, in order to find effective connectivity.
For this, implementations of PC and BCCD can be used.
PC is a widely used algorithm and as such, many implementations already exist.
An implementation of BCCD suitable for this project also exists at the department of Intelligent Systems of the Radboud university.

The datasets of structural and functional connectivity are available, so the first step of this step will be to get the implementations for the algorithms working on the dataset.
We will first try the PC-algorithm, for which a suitable implementation still needs to be found. This will be done by using only functional connectivity data and also by providing strucural connectivity data as a graph skeleton.
The BCCD-algorithm will be used afterwards, which will also be used with only functional data as well as with functional and structural connectivity data.
This will result in a connectivity matrix which represents the effective connectivity.
These results will then be evaluated by cross-subject comparison, to see whether the gained data is consistent.
If it is, then this algorithm is a potentially useful algorithm for determining effective connectivity.
As PC is a state-of-the-art algorighm \cite{spirtes2000}, and BCCD shows a good potential \cite{claassen2012}, this way of determining effective connectivity may very well be the case.


% Licht hier toe met welke methoden we gaan vergelijken en wat we nog meer besproken hebben in de outline.
% - Difficulties in causal discovery
% - Comparison methods
% - Comparison procedure
% - Properties

% week 50 is deadline voor draft, 51 is presentaties, 2 inleveren van final
\section{Time schedule}
\begin{ganttchart}{1}{10}
\gantttitle{2011}{10} \\
\gantttitlelist{40,...,52,1,2}{1} \\
\ganttgroup{Group 1}{1}{7} \\
\ganttbar{Task 1}{1}{2} \\
\ganttlinkedbar{Task 2}{3}{7} \ganttnewline
\ganttmilestone{Milestone}{7} \ganttnewline
\ganttbar{Final Task}{8}{12}
\ganttlink{elem2}{elem3}
\ganttlink{elem3}{elem4}
\end{ganttchart}


\bibliography{references}{}
\addcontentsline{toc}{section}{References}
\bibliographystyle{apalike}

\end{document}