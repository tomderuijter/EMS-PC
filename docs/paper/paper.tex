% Needed packages
\documentclass[a4paper, 10pt, english, twocolumn]{article}
\usepackage[english]{babel}
\usepackage[cm]{fullpage}
\usepackage{cite}
\usepackage{anysize}
\usepackage[compact]{titlesec}
\usepackage{graphicx}
\usepackage{stfloats}
\usepackage{listings}
\usepackage{hyperref}

\usepackage{amssymb,amsmath}
\usepackage{algorithmicx}
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}

% for coloring individual cells in a table
\usepackage[table]{xcolor}
%\usepackage{pgfgantt}

\newcommand{\keywords}[1]{\par\noindent 
{\bf Keywords\/}. #1}

% Margins & Headers
\marginsize{2.5cm}{2.5cm}{3.0cm}{2.0cm}
\columnsep 0.4in
\footskip 0.4in 
\usepackage{changepage}

% E-mail formatting
\usepackage{color,hyperref}
    \catcode`\_=11\relax
    \newcommand\email[1]{\_email #1\q_nil}
    \def\_email#1@#2\q_nil{
      \href{mailto:#1@#2}{{\emailfont #1\emailampersat #2}}
    }
    \newcommand\emailfont{\sffamily}
    \newcommand\emailampersat{{\color{red}\small@}}
    \catcode`\_=8\relax 
	
% List modifications
\newenvironment{packed_item}{
\begin{itemize}
  \setlength{\itemsep}{1pt}
  \setlength{\parskip}{0pt}
  \setlength{\parsep}{0pt}
}{\end{itemize}}

\newenvironment{packed_enum}{
\begin{enumerate}
  \setlength{\itemsep}{1pt}
  \setlength{\parskip}{0pt}
  \setlength{\parsep}{0pt}
}{\end{enumerate}}

% ### Mathematics ###
\newcommand{\bpm}{\begin{pmatrix}}
\newcommand{\epm}{\end{pmatrix}}

\newcommand{\bbm}{\begin{bmatrix}}
\newcommand{\ebm}{\end{bmatrix}}

\newcommand{\bsm}{\bigl( \begin{smallmatrix}}
\newcommand{\esm}{ \end{smallmatrix} \bigl)} 

\newcommand{\mbf}{\mathbf}

% ### Matrices and Vectors ###
\newcommand{\mtx}[1]{\ensuremath{\boldsymbol{#1}}}
\newcommand*\Let[2]{\State #1 $\gets$ #2}

% ### Sets ###
\newcommand{\set}[1]{\ensuremath{\mathcal{#1}}}

% ### Other ###

\newcommand{\transpose}{^{T}}
\newcommand{\inv}{^{-1}}
\newcommand{\pseudoinv}{^{+}}

% ### Hyphenation ###
\hyphenation{a-na-ly-sis}

% ############## End Macros ##############


% Title
\title{\fontfamily{phv}\selectfont{Causal Discovery methods for Effective Connectivity}}
\author{
  \textbf{R. Janssen} - \href{mailto:ramon.janssen@student.ru.nl}{ramon.janssen@student.ru.nl} \\
  \textbf{T. de Ruijter} - \href{mailto:t.deruijter@student.ru.nl}{t.deruijter@student.ru.nl}\\
%  \textbf{T. Claassen} - \href{mailto:tomc@cs.ru.nl}{tomc@cs.ru.nl}\\
%  \textbf{M. Hinne} - \href{mailto:mhinne@cs.ru.nl}{mhinne@cs.ru.nl}
}

\date{\fontfamily{ptm}\selectfont{\small{\bfseries{\today - Radboud
Universiteit Nijmegen}}}\\[0.5cm]\rule{\linewidth}{0.3mm}}

\begin{document}

\maketitle

\begin{abstract}
% TODO: Add abstract. Look at slides Peter to see what is asked.
\end{abstract}

\section{Introduction}

\paragraph{Motivation}
The brain and particularly the human brain have been studied for hundreds of years.
Today, the secrets of our brains still are one of the most sought-after.
The techniques however have changed.
We have come a long way since the time of Phrenology, the pseudoscience based attempting to derive cognitive ability and personality from measurements of the skull or, post-mortem, the brain.
Advanced measurement methods exist that allow scientists to peek inside brains that give a coarse but broad overview without opening a single skull.

Of particular interest are causal relations between brain regions and cognitive and bodily functions.
The question if brain region X is functionally or structurally connected to brain region Y and whether these are causally related is still highly relevant; it is the main question of the present-day scientific field of brain connectivity.
Understanding brain structure implies understanding more about the brain as a whole.

Not surprisingly, brain connectivity also finds applications in medicine.
Neuro-degenerative diseases such as Alzheimer's disease, Parkinson's disease, dementia, Amyotrophic lateral sclerosis (ALS) have all been shown to severely alter brain connectivity. %TODO: Citation needed.
Better methods for analysing connectivity could lead to more insight in these diseases.

The field of brain connectivity finds its roots in the early 1990s \cite{friston1993functional, friston1994}, though because of more recent developments in the field of Artificial Intelligence and Machine Learning it is possible to do more thorough analysis \cite{vandenheuvel2010}.
One type of connectivity analysis involves finding how brain region X causes what region Y does. This is called \emph{effective connectivity}.
More concretely: how does the measured fMRI signal, representing an underlying neuronal process, determine what other neuronal processes are activated.
Research regarding effective is relatively new and its application still faces many challenges that require further research \cite{ramsey2010}.
The directed character in effective connectivity seems similar to traditional causal relations.
In what follows, we suggest to use causal discovery methods for deriving effective connectivity.

\paragraph{Problem statement}
This project seeks to utilise the strengths of current state-of-the-art causal discovery methods by applying them to resting state brain fMRI data in order to find new applicable methods for determining causal patterns in the human brain.

The work by \cite{ramsey2010} addresses several problems causal analysis in fMRI analysis suffers from.
Methods in causal discovery have high computational costs, making it nearly impossible to calculate networks with more than hundreds of nodes.
Another important fact is that fMRI Analysis indirectly measures brain activity.
Brain models that do not account for possible latent - indirect - sources within the brain or the shortcomings of fMRI may suffer from noise, fail to capture underlying patterns or draw erroneous conclusions.
Solutions to this particular problem have been proposed that do account for latent sources \cite{ramsey2010, waldorp2011}.
Another problem is the strong diversity between subjects.
Every brain is inherently different, making it non-trivial to combine subject data or even draw conclusions across subjects.
Even within a single brain it changes how different areas react over time.

Several methods for finding effective connectivity already exist \cite{mclntosh1994, harrison2003, friston2003, roebroeck2005}.
However, using more generally applicable causal discovery methods has not been elaborated on much.
Also, none of these provide a measure of uncertainty.
It is a fact that there are errors in any graph produced.
This is inherent to the methods and the coarseness of the measurements.
As there is no standard baseline to compare results with, a measure of uncertainty would be highly preferable.
A framework for such a probabilistic approach is introduced in \cite{claassen2012}.

We would like to know whether applying such methods, such as the approach introduced in \cite{claassen2012}, or a standard approach such as the PC-algorithm \cite{spirtes2000} can solve some of the difficulties effective connectivity suffers from.

% Structure of the rest of proposal
In the remainder of this proposal we briefly discuss some necessary background knowledge on connectivity and methods, we then discuss our strategy and finally we present a time-plan overview.

\section{Theory}

\subsection{Causal discovery}
An approach for finding effective connectivity may be found in the domain of causal discovery.
A causal discovery method uses data about events to determine which of these events are correlated, and if possible, it determines which event causes which.
The definition of a causal relation is not trivial \cite{?} and the relevant principles will be covered in this section.
In our context, the causal discovery methods which have been used aim at inferring a Bayesian network.
This is done by calculating statistical (in)dependencies between stochastic variables.

Such a Bayesian network can be modelled as a graph with directed edges.
Each variable is represented by a node, and correlations between variables are represented by edges between those nodes.
A causal relation between variables $X$ and $Y$ is denoted with a directed edge; $X \rightarrow Y$ implies that $X$ is a cause of $Y$.
It is also said that $X$ is the parent of $Y$, and $Y$ is the child of $X$.
A Bayesian network cannot contain cycles, as that would imply that a variable is it's own (indirect) parent and thus it's own cause.
Ideally, a causal discovery methods finds only directed edges, resulting in a directed acyclic graph (DAG).
In practice, however, often not all causal relations can be inferred and undirected edges are also used in a graph.
As such, the result of a causal discovery method is a partially directed acyclic graph (PDAG).
Image {plaatje!} shows an example of a Bayesian network.
A causal discovery method attempts at finding a real-world Bayesian network.
But real-world situations like a brain are immensely complex and contain an unimaginable large number of atoms, which could all function as seperate variables.
As such, we represent our real-world, underlying Bayesian network with a much simpler model.
Such a model contains a reduced number of variables to be able to analyse and visualize the data.

An important principle for our approach is that of conditional dependence.
The dependency of two variables might depend on the value of a third variable (or possibly even more variables).
This principle is best demonstrated with an example.
When two variables, such as two switches being turned off or on, both cause a light bulb to glow, the two switches might not be dependent.
Whether one switch is turned on or off does not cause the other to switch on or off.
However, when the light bulb is glowing, the switches do become dependent.
If one switch is off, the other one is probably on.
Or in other words, one switch being turned on decreases the chance of the other switch being turned on.
In this case, we conclude that the switches are conditionally dependent given that the light bulb is turned on.
More generally, two variables $X$ and $Y$ can be conditionally dependent on a set of other variables $S$. % het juiste latex-symbooltje vinden :(

A similar principle is conditional independence. If two variables are 

Whether there is a dependency between two variables can be concluded by using a statistical test.
In this way, a graph can be inferred representing all dependencies between nodes.
However, this only results in an undirected graph, as it does not give any information about causality.
To derive causal relations, we can make use of conditional dependence.
Three rules for finding causality are used in the PC-algorithm.
One of those rules is based on conditional dependency 


\subsection{PC Algorithm}

\subsection{Brain Connectivity}

%Question: should this be included?
\subsubsection*{Functional connectivity}
Functional connectivity describes the statistical dependence of neuronal activity between different brain regions \cite{friston1993functional}.
This gives an insight in the organisation of the brain.
Functional connectivity is strongly time-dependent, as activity changes rapidly providing and fMRI has a low temporal resolution.
This means measured dependencies can be the result of statistical noise.
Functional connectivity can be deduced by fMRI measurement of brains in resting-state \cite{Lowe2000, doria2010, Bullmore2009}.
Resting state indicates that subjects are instructed to relax without thinking of anything in particular to stimulate spontaneous brain activity.

\subsubsection*{Structural connectivity}
Structural connectivity is defined as the mapping of anatomical - neural - paths in the brain between different brain regions \cite{friston1994}.
This is strongly related with functional connectivity: regions can only be functionally connected if there is a structural relation between them \cite{cabral2012}.
This intuitive relation can be demonstrated empirically \cite{vandenheuvel2009}.
Structural connectivity is less time dependent as it involves mappings of anatomical connections opposing temporal activity patterns.

Hinne et al. \cite{hinne2013} proposed a Bayesian method for estimating structural networks based on Diffusion Weighted MRI (DWI) and probabilistic Tractography.
The location of white-matter tracts does not become immediately clear from imagery alone.
Other methods rely on thresholds to estimate location of said tracts.
The proposed method results in a measure of uncertainty about where a hypothesised connection will terminate and so provides a clearly interpretable network structure as result.

\subsubsection*{Effective connectivity}
In contrast to functional and structural connectivity, effective connectivity takes into account the cause and effect of relations.
It has been described as ``the influence one neural system exerts over another'' \cite{friston1994}.
Effective connectivity indicates which brain regions stimulate other regions.
Time series need to be analysed to infer effective connectivity as cause and effect can be deduced from which event precedes which. 
It is possible to infer effective connectivity from structural and functional connectivity \cite{mclntosh1994, harrison2003, friston2003, roebroeck2005}.

Research has been done on inferring effective connectivity directly with several methods.
The most renowned methods are Granger causality \cite{roebroeck2005}, Structural Equation Modelling \cite{mclntosh1994}, Multivariate Autoregressive Modeling \cite{harrison2003} and Dynamic Causal Modelling \cite{friston2003}.
These are all methods dedicated to this problem.
These methods also suffer from similar problems of which perhaps the most important is scaling.
Most of these methods can only handle tens of nodes in reasonable time, which becomes problematic in realistic situations with up to tens of thousands of nodes, ideally.


\section{Methods}

\subsection*{Data acquisition \& analysis}
We will apply the mentioned methods on structural and functional data gathered from human subjects.
For this we are largely dependent on data collected by others.
Hinne et al. has provided fMRI time-series data and structural network data as used and derived in \cite{hinne2013}, of which six subjects were selected at random.
We can estimate functional connectivity from fMRI-measurement in combination with structural 
networks according to a procedure currently submitted by Hinne et al. \cite{hinne2013submitted}.
To find effective connectivity, both structural networks and functional data is needed.


\section{Results}

\section{Discussion}

\section{Conclusion}

\bibliography{references}{}
\addcontentsline{toc}{section}{References}
\bibliographystyle{plain}

\end{document}